{"ast":null,"code":"// const path = require('path');\n// require('dotenv').config({path: path.join(__dirname, '../.env')});\nconst SibApiV3Sdk = require('sib-api-v3-sdk'); // console.log(SibApiV3Sdk.ApiClient.instance)\n\n\nconst defaultClient = SibApiV3Sdk.ApiClient.instance; // const moment = require('moment');\n// Configure API key authorization: api-key\n\nlet apiKey = defaultClient.authentications['api-key'];\napiKey.apiKey = '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'; // // // Configure API key authorization: partner-key\n// let partnerKey = defaultClient.authentications['partner-key'];\n// partnerKey.apiKey = process.env.SIBKEY;\n// // send contact form submitted\n\nasync function sendContactForm(name, email, subject, phone, message) {\n  const apiInstance = new SibApiV3Sdk.TransactionalEmailsApi();\n  let sendSmtpEmail = new SibApiV3Sdk.SendSmtpEmail();\n  console.log('called');\n  sendSmtpEmail.sender = {\n    name: 'Greenscapes Gardening Sevices',\n    email: 'simon@greenscapes-gardening.co.uk'\n  };\n  sendSmtpEmail.to = [{\n    email: email,\n    name: name\n  }];\n  sendSmtpEmail.bcc = [{\n    email: 'simon@greenscapes-gardening.co.uk'\n  }];\n  sendSmtpEmail.replyTo = {\n    email: email\n  };\n  sendSmtpEmail.templateId = 1;\n  sendSmtpEmail.tags = ['support'];\n  sendSmtpEmail.params = {\n    FIRSTNAME: name,\n    MESSAGE: message,\n    PHONE: phone,\n    EMAIL: email\n  };\n\n  try {\n    const res = await apiInstance.sendTransacEmail(sendSmtpEmail);\n    console.log(res);\n    Promise.resolve(res);\n  } catch (error) {\n    console.log(error);\n    Promise.reject(error);\n  }\n} // create new contact\n\n\nfunction createNewContact(name, email, subject, phone, message) {\n  const apiInstance = new SibApiV3Sdk.ContactsApi();\n  let createContact = new SibApiV3Sdk.CreateContact();\n  createContact.email = email;\n  createContact.attributes = {\n    FIRSTNAME: name,\n    PHONENUMBER: phone\n  };\n  createContact.listIds = [3];\n  apiInstance.createContact(createContact).then(res => {\n    console.log(res);\n    return {\n      success: true,\n      msg: 'User added'\n    };\n  }).catch(e => console.log(e));\n}\n\nmodule.exports = {\n  sendContactForm,\n  createNewContact\n};","map":{"version":3,"sources":["/Users/user1/Documents/development/greenscapes/greenscapes-domestic/utils/sib.helpers.js"],"names":["SibApiV3Sdk","require","defaultClient","ApiClient","instance","apiKey","authentications","sendContactForm","name","email","subject","phone","message","apiInstance","TransactionalEmailsApi","sendSmtpEmail","SendSmtpEmail","console","log","sender","to","bcc","replyTo","templateId","tags","params","FIRSTNAME","MESSAGE","PHONE","EMAIL","res","sendTransacEmail","Promise","resolve","error","reject","createNewContact","ContactsApi","createContact","CreateContact","attributes","PHONENUMBER","listIds","then","success","msg","catch","e","module","exports"],"mappings":"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","sourcesContent":["// const path = require('path');\n// require('dotenv').config({path: path.join(__dirname, '../.env')});\n\nconst SibApiV3Sdk = require('sib-api-v3-sdk');\n// console.log(SibApiV3Sdk.ApiClient.instance)\nconst defaultClient = SibApiV3Sdk.ApiClient.instance;\n\n// const moment = require('moment');\n\n// Configure API key authorization: api-key\nlet apiKey = defaultClient.authentications['api-key'];\napiKey.apiKey = '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'\n\n// // // Configure API key authorization: partner-key\n// let partnerKey = defaultClient.authentications['partner-key'];\n// partnerKey.apiKey = process.env.SIBKEY;\n\n// // send contact form submitted\nasync function sendContactForm (name, email, subject, phone, message) {\n    const apiInstance = new SibApiV3Sdk.TransactionalEmailsApi();\n    let sendSmtpEmail = new SibApiV3Sdk.SendSmtpEmail();\n    console.log('called')\n\n    sendSmtpEmail.sender = {\n        name: 'Greenscapes Gardening Sevices',\n        email: 'simon@greenscapes-gardening.co.uk'\n    }\n    sendSmtpEmail.to = [\n        { email: email, name: name }        \n    ];\n    sendSmtpEmail.bcc = [{\n        email: 'simon@greenscapes-gardening.co.uk'\n    }]\n    sendSmtpEmail.replyTo = { email: email };\n    sendSmtpEmail.templateId = 1;\n    sendSmtpEmail.tags = ['support'];\n    sendSmtpEmail.params = {\n        FIRSTNAME: name,\n        MESSAGE: message,\n        PHONE: phone,\n        EMAIL: email\n    }\n    try {\n        const res = await apiInstance.sendTransacEmail(sendSmtpEmail);\n        console.log(res);\n        Promise.resolve(res);\n    } catch (error) {\n        console.log(error);\n        Promise.reject(error);\n    }\n}\n\n// create new contact\nfunction createNewContact (name, email, subject, phone, message) {\n    const apiInstance = new SibApiV3Sdk.ContactsApi();\n    let createContact = new SibApiV3Sdk.CreateContact();\n    createContact.email = email;\n    createContact.attributes = {\n        FIRSTNAME: name,\n        PHONENUMBER: phone\n    }\n    createContact.listIds = [3];\n    apiInstance.createContact(createContact)\n    .then((res) => {\n        console.log(res)\n        return ({ success: true, msg: 'User added' })\n    })\n    .catch(e => console.log(e))\n}\n\nmodule.exports = {\n    sendContactForm,\n    createNewContact\n}"]},"metadata":{},"sourceType":"script"}